# Don't change anything unless you know what you're doing
# documentation in doc/liquibase.md
databaseChangeLog:
  - changeSet:
      id: create-table-tapes
      author: MathiasSonderfeld
      changes:
        - createTable:
            tableName: tapes
            columns:
              - column:
                  name: id
                  type: UUID
                  constraints:
                    primaryKey: true
                    primaryKeyName: pk_tapes_id
              - column:
                  name: title
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: director
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: star
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: date_added
                  type: TIMESTAMP WITH TIME ZONE
  - changeSet:
      id: add-tapes-director-user-fk
      author: MathiasSonderfeld
      changes:
        - addForeignKeyConstraint:
            baseTableName: tapes
            baseColumnNames: director
            constraintName: fk_tapes_director
            referencedTableName: users
            referencedColumnNames: username
  - changeSet:
      id: add-tapes-star-user-fk
      author: MathiasSonderfeld
      changes:
        - addForeignKeyConstraint:
            baseTableName: tapes
            baseColumnNames: star
            constraintName: fk_tapes_star
            referencedTableName: users
            referencedColumnNames: username
  - changeSet:
      id: add-index-tapes-date-added
      author: MathiasSonderfeld
      changes:
        - createIndex:
            indexName: idx_tapes_date_added
            tableName: tapes
            columns:
              - column:
                  name: date_added
  - changeSet:
      id: add-index-tapes-director
      author: MathiasSonderfeld
      changes:
        - createIndex:
            indexName: idx_tapes_director
            tableName: tapes
            columns:
              - column:
                  name: director
  - changeSet:
      id: add-index-tapes-star
      author: MathiasSonderfeld
      changes:
        - createIndex:
            indexName: idx_tapes_star
            tableName: tapes
            columns:
              - column:
                  name: star